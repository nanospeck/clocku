<!DOCTYPE html>
<html>
   <body>
      <canvas id="canvas" width="600" height="600" style="background-color:#333"></canvas>
<!--      <canvas id="piechart" width="200" height="200"></canvas>-->
      <script>
         var canvas = document.getElementById("canvas");
         var ctx = canvas.getContext("2d");
         var radius = canvas.height / 2;
         console.log("radius ref 1:"+ radius*0.90);
         console.log("canvas height ref 1:"+ canvas.height);
         console.log("canvas width ref 1:"+ canvas.width);
         ctx.translate(radius, radius);
         radius = radius * 0.90
         //drawClock();
         setInterval(drawClock, 1000);
         
         function drawClock() {
             drawFace(ctx, radius);
             drawNumbers(ctx, radius);
             drawTime(ctx, radius, canvas);
         }

    function drawFace(ctx, radius) {
             var grad;
             console.log("radius ref drawFace:"+ radius);
             ctx.beginPath();
             ctx.arc(0, 0, radius, 0, 2*Math.PI);
             ctx.fillStyle = 'white';
             ctx.fill();
         
             //radial outer border
             grad = ctx.createRadialGradient(0,0,radius*0.95, 0,0,radius*1.05);
             grad.addColorStop(0, '#333');
             grad.addColorStop(0.5, 'white');
             grad.addColorStop(1, '#333');
             ctx.strokeStyle = grad;
             ctx.lineWidth = radius*0.1;
             ctx.stroke();
             ctx.beginPath();
             ctx.arc(0, 0, radius*0.1, 0, 2*Math.PI);
             ctx.fillStyle = '#333';
             ctx.fill();
         }
             function drawNumbers(ctx, radius) {
             console.log("radius ref drawNumbers:"+ radius*0.90);
             var ang;
             var num;
             ctx.font = radius*0.15 + "px arial";
             ctx.textBaseline="middle";
             ctx.textAlign="center";
             //for(num= 1; num < 13; num++){
                 for(num= 6; num < 7; num++){
                 ang = num * Math.PI / 6;
                 ctx.rotate(ang);
                 ctx.translate(0, -radius*0.85);
                 ctx.rotate(-ang);
                 ctx.fillText("|", 0, 0);
                 ctx.rotate(ang);
                 ctx.translate(0, radius*0.85);
                 ctx.rotate(-ang);
             }
         }
             function drawTime(ctx, radius, canvas){
                  // pie
             // 15 mins = pos 1.5 , 30 mins= 3pos, 60 mins = 6 pos
                  for (var i = 0; i < data.length; i++) {
                    drawSegment(canvas, ctx, i);
                }
                  console.log("radius ref drawTime:"+ radius*0.90);

             //drawFace(ctx, radius);
                 //drawClockCenter();
                 drawNumbers(ctx, radius);
             var now = new Date();
             var hour = now.getHours();
             var minute = now.getMinutes();
             var second = now.getSeconds();
             //hour
             hour=hour%12;
             hour=(hour*Math.PI/6)+(minute*Math.PI/(6*60))+(second*Math.PI/(360*60));
             console.log("hour :" + hour);
             drawHand(ctx, hour, radius*0.5, radius*0.07);
             //minute
             minute=(minute*Math.PI/30)+(second*Math.PI/(30*60));
                 console.log("minute :" + minute);
             drawHand(ctx, minute, radius*0.8, radius*0.07);
             // second
             second=(second*Math.PI/30);
                 console.log("second :" + second);
             drawHand(ctx, second, radius*0.9, radius*0.02);
            
         }
         
         function drawHand(ctx, pos, length, width) {
             ctx.beginPath();
             ctx.lineWidth = width;
             ctx.lineCap = "round";
             ctx.moveTo(0,0);
             ctx.rotate(pos);
             ctx.lineTo(0, -length);
             ctx.stroke();
             ctx.rotate(-pos);
         }
            var inside =true;
         
         //phase 2
         var data = [120, 50, 100,90];
         var labels = ["Code", "Tea-Break", "AppScan",  "Meeting"];
         var colors = ["#FFDAB9", "#E6E6FA", "#E0FFFF", "#B0FFFF"];
         
               
         function drawSegment(canvas, context, i) {
         context.save();
         if(!inside){
             var centerX = Math.floor(canvas.width / 2);
          var centerY = Math.floor(canvas.height / 2);
         }else{
              var centerX = 0;
              var centerY = 0;
         }
         //radius = Math.floor(canvas.width / 2);
         console.log("radius ref 2:"+ radius);
         console.log("canvas height ref 2:"+ canvas.height);
         console.log("canvas width ref 2:"+ canvas.width);
         var startingAngle = degreesToRadians(sumTo(data, i));
         var arcSize = degreesToRadians(data[i]);
         var endingAngle = startingAngle + arcSize;
         
         context.beginPath();
         context.moveTo(centerX, centerY);
         context.arc(centerX, centerY, radius*0.93, 
                   startingAngle, endingAngle, false);
         context.closePath();
         context.globalAlpha=0.5; 
         context.fillStyle = colors[i];
         context.fill();
         context.restore();
         drawSegmentLabel(canvas, context, i);
         }
               function degreesToRadians(degrees) {
         return (degrees * Math.PI)/180;
         }
         function sumTo(a, i) {
         var sum = 0;
         for (var j = 0; j < i; j++) {
         sum += a[j];
         }
         return sum;
         }
      
        function drawSegmentLabel(canvas, context, i) {
         context.save();
          if(!inside){
             var x = Math.floor(canvas.width / 2);
          var y = Math.floor(canvas.height / 2);
         }else{
              var x = 0;
              var y = 0;
         }
         var angle = degreesToRadians(sumTo(data, i));
         context.translate(x, y);
         context.rotate(angle);
         var dx = Math.floor(canvas.width * 0.5) - 50;
         var dy = Math.floor(canvas.height * 0.05);
         context.textAlign = "right";
         var fontSize = Math.floor(canvas.height / 25);
         context.font = fontSize + "pt Helvetica";
         context.fillText(labels[i], dx, dy);
         context.restore();
         }
        if(!inside){
        var canvas2 = document.getElementById("piechart");
         var context2 = canvas2.getContext("2d");
         for (var i = 0; i < data.length; i++) {
         drawSegment(canvas2, context2, i);
         }          
        }
           
      </script>
   </body>
</html>
